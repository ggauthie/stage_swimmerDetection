/**
 * @file Core0.c
 * @generated by CPrinter
 * @date Fri Jun 18 17:03:22 CEST 2021
 *
 * Code generated for processing element Core0 (ID=0).
 */

#include "preesm_gen.h"
// Core Global Declaration
extern pthread_barrier_t iter_barrier;
extern int preesmStopThreads;

#ifdef PREESM_MD5_UPDATE
extern struct rk_sema preesmPrintSema;
#endif

// Core Global Definitions
char Shared[6524944]; //  size:= 6524944*char
char *const mp4Read_0__split_0__0 = (char*) (Shared + 0);  // mp4Read_0 > split_0 size:= 691200*char
char *const mp4Read_0__resize_0__0 = (char*) (Shared + 691200);  // mp4Read_0 > resize_0 size:= 691200*char
char *const split_0__explode_split_0_output__0 = (char*) (Shared + 1382400); // split_0 > explode_split_0_output size:= 721920*char
char *const explode_split_0_output__medianFilter_0__0 = (char*) (Shared + 2104320); // explode_split_0_output > medianFilter_0 size:= 90240*char
char *const explode_split_0_output__medianFilter_1__0 = (char*) (Shared + 2194560); // explode_split_0_output > medianFilter_1 size:= 90240*char
char *const explode_split_0_output__medianFilter_2__0 = (char*) (Shared + 2284800); // explode_split_0_output > medianFilter_2 size:= 90240*char
char *const explode_split_0_output__medianFilter_3__0 = (char*) (Shared + 2375040); // explode_split_0_output > medianFilter_3 size:= 90240*char
char *const explode_split_0_output__medianFilter_4__0 = (char*) (Shared + 2465280); // explode_split_0_output > medianFilter_4 size:= 90240*char
char *const explode_split_0_output__medianFilter_5__0 = (char*) (Shared + 2555520); // explode_split_0_output > medianFilter_5 size:= 90240*char
char *const explode_split_0_output__medianFilter_6__0 = (char*) (Shared + 2645760); // explode_split_0_output > medianFilter_6 size:= 90240*char
char *const explode_split_0_output__medianFilter_7__0 = (char*) (Shared + 2736000); // explode_split_0_output > medianFilter_7 size:= 90240*char
char *const medianFilter_0__cvtColor_0__0 = (char*) (Shared + 2826240); // medianFilter_0 > cvtColor_0 size:= 90240*char
char *const medianFilter_1__cvtColor_1__0 = (char*) (Shared + 2916480); // medianFilter_1 > cvtColor_1 size:= 90240*char
char *const medianFilter_2__cvtColor_2__0 = (char*) (Shared + 3006720); // medianFilter_2 > cvtColor_2 size:= 90240*char
char *const medianFilter_3__cvtColor_3__0 = (char*) (Shared + 3096960); // medianFilter_3 > cvtColor_3 size:= 90240*char
char *const medianFilter_4__cvtColor_4__0 = (char*) (Shared + 3187200); // medianFilter_4 > cvtColor_4 size:= 90240*char
char *const medianFilter_5__cvtColor_5__0 = (char*) (Shared + 3277440); // medianFilter_5 > cvtColor_5 size:= 90240*char
char *const medianFilter_6__cvtColor_6__0 = (char*) (Shared + 3367680); // medianFilter_6 > cvtColor_6 size:= 90240*char
char *const medianFilter_7__cvtColor_7__0 = (char*) (Shared + 3457920); // medianFilter_7 > cvtColor_7 size:= 90240*char
char *const cvtColor_0__implode_merge_0_input__0 = (char*) (Shared + 3548160); // cvtColor_0 > implode_merge_0_input size:= 90240*char
char *const cvtColor_1__implode_merge_0_input__0 = (char*) (Shared + 3638400); // cvtColor_1 > implode_merge_0_input size:= 90240*char
char *const cvtColor_2__implode_merge_0_input__0 = (char*) (Shared + 3728640); // cvtColor_2 > implode_merge_0_input size:= 90240*char
char *const cvtColor_3__implode_merge_0_input__0 = (char*) (Shared + 3818880); // cvtColor_3 > implode_merge_0_input size:= 90240*char
char *const cvtColor_4__implode_merge_0_input__0 = (char*) (Shared + 3909120); // cvtColor_4 > implode_merge_0_input size:= 90240*char
char *const cvtColor_5__implode_merge_0_input__0 = (char*) (Shared + 3999360); // cvtColor_5 > implode_merge_0_input size:= 90240*char
char *const cvtColor_6__implode_merge_0_input__0 = (char*) (Shared + 4089600); // cvtColor_6 > implode_merge_0_input size:= 90240*char
char *const cvtColor_7__implode_merge_0_input__0 = (char*) (Shared + 4179840); // cvtColor_7 > implode_merge_0_input size:= 90240*char
char *const implode_merge_0_input__merge_0__0 = (char*) (Shared + 4270080); // implode_merge_0_input > merge_0 size:= 721920*char
char *const merge_0__mask_0__0 = (char*) (Shared + 4992000);  // merge_0 > mask_0 size:= 691200*char
char *const mask_0__boxConstruction_0__0 = (char*) (Shared + 5683200);  // mask_0 > boxConstruction_0 size:= 691200*char
char *const boxConstruction_0__resize_0__0 = (char*) (Shared + 6374400);  // boxConstruction_0 > resize_0 size:= 16*char
char *const resize_0__mp4display_0__0 = (char*) (Shared + 6374416);  // resize_0 > mp4display_0 size:= 150528*char
unsigned char *const pixels__input__0 = (unsigned char*) (Shared + 0); // mp4Read_0_pixels > split_0_input size:= 691200*unsigned char
unsigned char *const output2__src__0 = (unsigned char*) (Shared + 691200); // mp4Read_0_output2 > resize_0_src size:= 691200*unsigned char
unsigned char *const output__src__0 = (unsigned char*) (Shared + 1382400); // split_0_output > explode_split_0_output_src size:= 721920*unsigned char
unsigned char *const output_0__src__0 = (unsigned char*) (Shared + 2104320); // explode_split_0_output_output_0 > medianFilter_0_src size:= 90240*unsigned char
unsigned char *const output_1__src__0 = (unsigned char*) (Shared + 2194560); // explode_split_0_output_output_1 > medianFilter_1_src size:= 90240*unsigned char
unsigned char *const output_2__src__0 = (unsigned char*) (Shared + 2284800); // explode_split_0_output_output_2 > medianFilter_2_src size:= 90240*unsigned char
unsigned char *const output_3__src__0 = (unsigned char*) (Shared + 2375040); // explode_split_0_output_output_3 > medianFilter_3_src size:= 90240*unsigned char
unsigned char *const output_4__src__0 = (unsigned char*) (Shared + 2465280); // explode_split_0_output_output_4 > medianFilter_4_src size:= 90240*unsigned char
unsigned char *const output_5__src__0 = (unsigned char*) (Shared + 2555520); // explode_split_0_output_output_5 > medianFilter_5_src size:= 90240*unsigned char
unsigned char *const output_6__src__0 = (unsigned char*) (Shared + 2645760); // explode_split_0_output_output_6 > medianFilter_6_src size:= 90240*unsigned char
unsigned char *const output_7__src__0 = (unsigned char*) (Shared + 2736000); // explode_split_0_output_output_7 > medianFilter_7_src size:= 90240*unsigned char
unsigned char *const dest__src__0 = (unsigned char*) (Shared + 2826240); // medianFilter_0_dest > cvtColor_0_src size:= 90240*unsigned char
unsigned char *const dest__src__1 = (unsigned char*) (Shared + 2916480); // medianFilter_1_dest > cvtColor_1_src size:= 90240*unsigned char
unsigned char *const dest__src__2 = (unsigned char*) (Shared + 3006720); // medianFilter_2_dest > cvtColor_2_src size:= 90240*unsigned char
unsigned char *const dest__src__3 = (unsigned char*) (Shared + 3096960); // medianFilter_3_dest > cvtColor_3_src size:= 90240*unsigned char
unsigned char *const dest__src__4 = (unsigned char*) (Shared + 3187200); // medianFilter_4_dest > cvtColor_4_src size:= 90240*unsigned char
unsigned char *const dest__src__5 = (unsigned char*) (Shared + 3277440); // medianFilter_5_dest > cvtColor_5_src size:= 90240*unsigned char
unsigned char *const dest__src__6 = (unsigned char*) (Shared + 3367680); // medianFilter_6_dest > cvtColor_6_src size:= 90240*unsigned char
unsigned char *const dest__src__7 = (unsigned char*) (Shared + 3457920); // medianFilter_7_dest > cvtColor_7_src size:= 90240*unsigned char
unsigned char *const dest__input_0__0 = (unsigned char*) (Shared + 3548160); // cvtColor_0_dest > implode_merge_0_input_input_0 size:= 90240*unsigned char
unsigned char *const dest__input_1__0 = (unsigned char*) (Shared + 3638400); // cvtColor_1_dest > implode_merge_0_input_input_1 size:= 90240*unsigned char
unsigned char *const dest__input_2__0 = (unsigned char*) (Shared + 3728640); // cvtColor_2_dest > implode_merge_0_input_input_2 size:= 90240*unsigned char
unsigned char *const dest__input_3__0 = (unsigned char*) (Shared + 3818880); // cvtColor_3_dest > implode_merge_0_input_input_3 size:= 90240*unsigned char
unsigned char *const dest__input_4__0 = (unsigned char*) (Shared + 3909120); // cvtColor_4_dest > implode_merge_0_input_input_4 size:= 90240*unsigned char
unsigned char *const dest__input_5__0 = (unsigned char*) (Shared + 3999360); // cvtColor_5_dest > implode_merge_0_input_input_5 size:= 90240*unsigned char
unsigned char *const dest__input_6__0 = (unsigned char*) (Shared + 4089600); // cvtColor_6_dest > implode_merge_0_input_input_6 size:= 90240*unsigned char
unsigned char *const dest__input_7__0 = (unsigned char*) (Shared + 4179840); // cvtColor_7_dest > implode_merge_0_input_input_7 size:= 90240*unsigned char
unsigned char *const dest__input__0 = (unsigned char*) (Shared + 4270080); // implode_merge_0_input_dest > merge_0_input size:= 721920*unsigned char
unsigned char *const output__src__1 = (unsigned char*) (Shared + 4992000); // merge_0_output > mask_0_src size:= 691200*unsigned char
unsigned char *const dest__src__8 = (unsigned char*) (Shared + 5683200); // mask_0_dest > boxConstruction_0_src size:= 691200*unsigned char
int *const x_rect__x_rect__0 = (int*) (Shared + 6374400);  // boxConstruction_0_x_rect > resize_0_x_rect size:= 1*int
int *const y_rect__y_rect__0 = (int*) (Shared + 6374404);  // boxConstruction_0_y_rect > resize_0_y_rect size:= 1*int
int *const height_rect__height_rect__0 = (int*) (Shared + 6374408); // boxConstruction_0_height_rect > resize_0_height_rect size:= 1*int
int *const width_rect__width_rect__0 = (int*) (Shared + 6374412); // boxConstruction_0_width_rect > resize_0_width_rect size:= 1*int
unsigned char *const dest__pixels__0 = (unsigned char*) (Shared + 6374416); // resize_0_dest > mp4display_0_pixels size:= 150528*unsigned char

void* computationThread_Core0(void *arg) {
  if (arg != NULL) {
    printf("Warning: expecting NULL arguments\n");
    fflush (stdout);
  }

#ifdef PREESM_MD5_UPDATE
	PREESM_MD5_CTX preesm_md5_ctx_dest__pixels__0;
	PREESM_MD5_Init(&preesm_md5_ctx_dest__pixels__0);
#endif
  // Initialisation(s)
  initMp4Read(1/*video_file*/, 0/*pix_fmt*/); // mp4Read_0

  initMp4Display(224/*width*/, 224/*height*/); // mp4display_0

  // Begin the execution loop
  pthread_barrier_wait(&iter_barrier);
#ifdef PREESM_LOOP_SIZE // Case of a finite loop
	int index;
	for(index=0;index<PREESM_LOOP_SIZE && !preesmStopThreads;index++){
#else // Default case of an infinite loop
  while (!preesmStopThreads) {
#endif
    // loop body
    mp4Read(640/*width*/, 360/*height*/, pixels__input__0, output2__src__0); // mp4Read_0

    split(8/*nbSlice*/, 640/*width*/, 360/*height*/, pixels__input__0, output__src__0); // split_0

    // Fork explode_split_0_output

    {
      memcpy(output_0__src__0 + 0, output__src__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(output_1__src__0 + 0, output__src__0 + 90240, 90240 * sizeof(unsigned char));
      memcpy(output_2__src__0 + 0, output__src__0 + 180480, 90240 * sizeof(unsigned char));
      memcpy(output_3__src__0 + 0, output__src__0 + 270720, 90240 * sizeof(unsigned char));
      memcpy(output_4__src__0 + 0, output__src__0 + 360960, 90240 * sizeof(unsigned char));
      memcpy(output_5__src__0 + 0, output__src__0 + 451200, 90240 * sizeof(unsigned char));
      memcpy(output_6__src__0 + 0, output__src__0 + 541440, 90240 * sizeof(unsigned char));
      memcpy(output_7__src__0 + 0, output__src__0 + 631680, 90240 * sizeof(unsigned char));
    }
    medianFilter(output_0__src__0, dest__src__0, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_0

    medianFilter(output_1__src__0, dest__src__1, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_1

    medianFilter(output_2__src__0, dest__src__2, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_2

    medianFilter(output_3__src__0, dest__src__3, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_3

    medianFilter(output_4__src__0, dest__src__4, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_4

    medianFilter(output_5__src__0, dest__src__5, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_5

    medianFilter(output_6__src__0, dest__src__6, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_6

    medianFilter(output_7__src__0, dest__src__7, 640/*width*/, 47/*height*/, 3/*nb_channels*/); // medianFilter_7

    cvtColorHSV(dest__src__0, dest__input_0__0, 640/*width*/, 47/*height*/); // cvtColor_0

    cvtColorHSV(dest__src__1, dest__input_1__0, 640/*width*/, 47/*height*/); // cvtColor_1

    cvtColorHSV(dest__src__2, dest__input_2__0, 640/*width*/, 47/*height*/); // cvtColor_2

    cvtColorHSV(dest__src__3, dest__input_3__0, 640/*width*/, 47/*height*/); // cvtColor_3

    cvtColorHSV(dest__src__4, dest__input_4__0, 640/*width*/, 47/*height*/); // cvtColor_4

    cvtColorHSV(dest__src__5, dest__input_5__0, 640/*width*/, 47/*height*/); // cvtColor_5

    cvtColorHSV(dest__src__6, dest__input_6__0, 640/*width*/, 47/*height*/); // cvtColor_6

    cvtColorHSV(dest__src__7, dest__input_7__0, 640/*width*/, 47/*height*/); // cvtColor_7

    // Join implode_merge_0_input

    {
      memcpy(dest__input__0 + 0, dest__input_0__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 90240, dest__input_1__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 180480, dest__input_2__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 270720, dest__input_3__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 360960, dest__input_4__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 451200, dest__input_5__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 541440, dest__input_6__0 + 0, 90240 * sizeof(unsigned char));
      memcpy(dest__input__0 + 631680, dest__input_7__0 + 0, 90240 * sizeof(unsigned char));
    }
    merge(8/*nbSlice*/, 640/*width*/, 360/*height*/, dest__input__0, output__src__1); // merge_0

    maskCreationSimple(output__src__1, dest__src__8, 640/*width*/, 360/*height*/); // mask_0

    boxConstruction(dest__src__8, 640/*width*/, 360/*height*/, x_rect__x_rect__0, y_rect__y_rect__0,
        width_rect__width_rect__0, height_rect__height_rect__0); // boxConstruction_0

    resize(output2__src__0, dest__pixels__0, x_rect__x_rect__0, y_rect__y_rect__0, width_rect__width_rect__0,
        height_rect__height_rect__0, 640/*width*/, 360/*height*/, 224/*width_final*/, 224/*height_final*/); // resize_0

    mp4Display(224/*width*/, 224/*height*/, dest__pixels__0); // mp4display_0
#ifdef PREESM_MD5_UPDATE
		PREESM_MD5_Update(&preesm_md5_ctx_dest__pixels__0,(char *)dest__pixels__0, 150528);
		#endif

    // loop footer
    pthread_barrier_wait(&iter_barrier);

  }

#ifdef PREESM_MD5_UPDATE
	// Print MD5
	rk_sema_wait(&preesmPrintSema);
	unsigned char preesm_md5_chars_final[20] = { 0 };
	PREESM_MD5_Final(preesm_md5_chars_final, &preesm_md5_ctx_dest__pixels__0);
	printf("preesm_md5_dest__pixels__0 : ");
	for (int i = 16; i > 0; i -= 1){
		printf("%02x", *(preesm_md5_chars_final + i - 1));
	}
	printf("\n");
	fflush(stdout);
	rk_sema_post(&preesmPrintSema);
#endif

  return NULL;
}

